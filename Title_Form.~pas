unit Title_Form;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Buttons, jpeg, ExtCtrls, Grids, DBGrids, basa_dan, StdCtrls, AuthorizationData,
  ShellAPI;

type
  TTitleForm = class(TForm)
    Image1: TImage;
    SpeedButton2: TSpeedButton;
    SpeedButton3: TSpeedButton;
    Label1: TLabel;
    DBGrid1: TDBGrid;
    Image2: TImage;
    SpeedButton4: TSpeedButton;
    Button1: TButton;
    Button2: TButton;
    Button3: TButton;
    Button4: TButton;
    Button5: TButton;
    Button6: TButton;
    Button7: TButton;
    Button8: TButton;
    Button9: TButton;
    Button10: TButton;
    Button12: TButton;
    Button13: TButton;
    Image4: TImage;
    SpeedButton1: TSpeedButton;
    procedure SpeedButton2Click(Sender: TObject);
    procedure SpeedButton4Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure Button6Click(Sender: TObject);
    procedure Button7Click(Sender: TObject);
    procedure Button8Click(Sender: TObject);
    procedure Button9Click(Sender: TObject);
    procedure Button10Click(Sender: TObject);
    procedure Button12Click(Sender: TObject);
    procedure Button13Click(Sender: TObject);
    procedure SpeedButton1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  TitleForm: TTitleForm;

implementation

uses Unit2, Menu_Lectures, Menu_Practic, Menu_Control, Tema_CRUD,
  Practic_CRUD, Razdel_CRUD, Lecture_CRUD, Control_CRUD, Ycheniki_CRUD,
  Main_Menu, Add_Question, EditLecture, config;


{$R *.dfm}

procedure TTitleForm.SpeedButton2Click(Sender: TObject);
var temp:word;
begin
    temp:=MessageBox(0,'Вы точно хотите выйти из программы?','Программирование и защита Web - приложений',
    MB_YESNO+MB_ICONQUESTION);
    if idyes=temp then
      TitleForm.close;
end;

procedure TTitleForm.SpeedButton4Click(Sender: TObject);
var i:integer;
begin
   AuthorizationForm.Show;
   AuthorizationForm.Position:=poDesktopCenter;
   TitleForm.Visible:=false;

   AuthorizationForm.Position:=poDesktopCenter;
   config.selectRequestSQL('SELECT * FROM Ученик');
   DBGrid1.DataSource.DataSet.First;
   for i:=1 to DBGrid1.DataSource.DataSet.RecordCount do
      begin
        AuthorizationForm.DBComboBox1.Items.Add(DBGrid1.DataSource.DataSet.FieldByName('login').AsString);
        DBGrid1.DataSource.DataSet.Next;
      end;

end;

procedure TTitleForm.Button1Click(Sender: TObject);    //  РАБОТА С  ЛЕКЦИИ - УЧЕНИК
begin
    MenuLectures.show;
    MenuLectures.ComboBox1.Items.Clear;
    config.selectRequestSQL('SELECT * FROM Раздел');  //Заполнение ComboBox при создании
    DBGrid1.DataSource.DataSet.First;
    While (DBGrid1.DataSource.DataSet.Eof=false) do
      begin
        MenuLectures.ComboBox1.Items.Add(DBGrid1.DataSource.DataSet.FieldByName('НазваниеРаздела').AsString);
        DBGrid1.DataSource.DataSet.Next;
      end;
    DBGrid1.DataSource.DataSet.First;
    MenuLectures.ComboBox1.Text:=DBGrid1.DataSource.DataSet.FieldByName('НазваниеРаздела').AsString;  //  конец создания
end;

procedure TTitleForm.Button2Click(Sender: TObject);     //  РАБОТА С  ПРАКТИКЧЕСКИМИ - УЧЕНИК
begin
    MenuPractic.show;
    MenuPractic.ComboBox2.Items.Clear;
    config.selectRequestSQL('SELECT * FROM Раздел');  //Заполнение ComboBox при создании
    DBGrid1.DataSource.DataSet.First;
    While (DBGrid1.DataSource.DataSet.Eof=false) do
      begin
        MenuPractic.ComboBox1.Items.Add(DBGrid1.DataSource.DataSet.FieldByName('НазваниеРаздела').AsString);
        DBGrid1.DataSource.DataSet.Next;
      end;
    DBGrid1.DataSource.DataSet.First;
    MenuPractic.ComboBox1.Text:=DBGrid1.DataSource.DataSet.FieldByName('НазваниеРаздела').AsString;  //  конец создания
end;

procedure TTitleForm.Button10Click(Sender: TObject);  //  РАБОТА С Контролем знаний - УЧЕНИК
begin
    MenuControl.show;
    MenuControl.ComboBox1.Items.Clear;
    MenuControl.ComboBox2.Items.Clear;
    config.selectRequestSQL('SELECT * FROM Раздел');  //Заполнение ComboBox при создании
    DBGrid1.DataSource.DataSet.First;
    While (DBGrid1.DataSource.DataSet.Eof=false) do
      begin
        MenuControl.ComboBox1.Items.Add(DBGrid1.DataSource.DataSet.FieldByName('НазваниеРаздела').AsString);
        DBGrid1.DataSource.DataSet.Next;
      end;
    DBGrid1.DataSource.DataSet.First;
    MenuControl.ComboBox1.Text:=DBGrid1.DataSource.DataSet.FieldByName('НазваниеРаздела').AsString;  //  конец создания
end;

procedure TTitleForm.Button3Click(Sender: TObject);
begin
    TemaCRUD.show;
end;

procedure TTitleForm.Button4Click(Sender: TObject);
begin
    PracticCRUD.show;
end;

procedure TTitleForm.Button5Click(Sender: TObject);
begin
    RazdelCRUD.Show;
end;

procedure TTitleForm.Button6Click(Sender: TObject);
begin
    LectureCRUD.show;
end;

procedure TTitleForm.Button7Click(Sender: TObject);
begin
    ControlCRUD.show;
end;

procedure TTitleForm.Button8Click(Sender: TObject);
begin
    YchenikiCRUD.show;
end;

procedure TTitleForm.Button9Click(Sender: TObject);
begin
    Mainmenu.show;
end;

procedure TTitleForm.Button12Click(Sender: TObject);
begin
    Add_Questions.Show;
end;

procedure TTitleForm.Button13Click(Sender: TObject);
begin
    Edit_Lecture.show;
end;

procedure TTitleForm.SpeedButton1Click(Sender: TObject);
begin
   ShellExecute(Handle, nil, 'https://www.simbirsoft.com', nil, nil, SW_SHOW);
end;

end.
